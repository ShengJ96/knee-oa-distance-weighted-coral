# ConvNeXt-Tiny GPU debug configuration with Albumentations pipeline
experiment:
  name: stage4_convnext_tiny_gpu_debug
  seed: 123
  output_dir: experiments/models/advanced_dl/stage4_convnext_tiny_gpu_debug
  figures_dir: experiments/figures/stage4_convnext_tiny_gpu_debug
  reports_dir: experiments/reports/stage4_convnext_tiny_gpu_debug

model:
  registry: advanced_cnn
  key: convnext_tiny
  params:
    num_classes: 5
    pretrained: false
    classifier_dropout: 0.3
    freeze_backbone: false

data:
  root: dataset/set_a
  target_size: [288, 288]
  batch_size: 8
  num_workers: 0
  limit_per_class: 4
  limit_per_class_val: 4
  limit_per_class_test: 4
  medical_variant: clahe
  augmentation:
    library: albumentations
    variant: advanced
    augment_train: true
    eval_library: torchvision

training:
  epochs: 1
  save_best: true
  save_last: true
  early_stopping_patience: 1
  amp: true
  grad_accum_steps: 1

optimization:
  optimizer: adamw
  learning_rate: 0.00015
  head_learning_rate: 0.0004
  weight_decay: 0.02
  grad_clip_norm: 1.0

scheduler:
  name: one_cycle
  params:
    max_lr: 0.0006
    pct_start: 0.1
    anneal_strategy: cos

knowledge_distillation:
  enable: false
  teacher_checkpoint: null

evaluation:
  metrics: [accuracy, f1_macro, cohen_kappa]
  attention_viz:
    enable: false
